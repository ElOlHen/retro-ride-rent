<h1>Welcome to Your Dashboard, <%= current_user.username.capitalize %></h1>
<button type="button" class="car-info-btn-small" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    Add a car
</button>


<%# Modals %>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Your car informations</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= render 'cars/new', car: @car %>
      </div>
    </div>
  </div>
</div>

<%# End of Modals %>


<a href="#my-cars" class="car-info-btn-small">My cars</a>
<a href="#my-bookings" class="car-info-btn-small">My bookings</a>

<section class="section-1" id="my-cars">
  <h2>My Cars</h2>
  <% if current_user.cars.any? %>
    <div class="row mx-2">
      <% current_user.cars.each do |car| %>
        <div class="col-md-4 mb-4">
          <div class="card h-100 position-relative">
            <%= image_tag car.photo_url, class: 'card-img-top', id: 'dashboard-car-img', alt: 'Car Image' %>
            <div class="card-body">
              <h5 class="card-title"><strong><%= car.brand %></strong></h5>
              <p class="card-text text-truncate"><%= car.price %> â‚¬</p>
              <%= link_to "More details", car_path(car), class: "btn btn-info btn-sm car-info-btn" %>
            </div>
            <div class="position-absolute bottom-0 start-0">
              <%= link_to car_path(car), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} do%>
                <i class="fa-solid fa-trash"></i>
              <% end %>
            </div>
            <% if car.bookings.any? %>
              <div class="position-absolute bottom-0 end-0">


               <button type="button" class="car-info-btn-small" data-bs-toggle="modal" data-bs-target="#toto">
                  Booking requests
              </button>

              </div>
            <% else %>
              <div class="position-absolute bottom-0 end-0">
                No Booking Request
              </div>
            <% end %>
          </div>
        </div>

        <% # Add modal for booking request if car is booked %>
        <% if car.bookings.any? %>
          <div class="modal fade" id="toto" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="totoLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="totoLabel">Your car informations</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <% car.bookings.each do |booking| %>
                    <p><strong>Date:</strong> <%= booking.date_begin %> to <%= booking.date_end %></p>
                    <p><strong>Message:</strong> <%= booking.message %></p>
                  <% end %>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-danger" data-dismiss="modal">Decline</button>
                  <button type="button" class="btn btn-success">Accept</button>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>


      <% # Add empty cards if there are fewer than 3 cars %>
      <% (3 - current_user.cars.count).times do %>
        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <!-- Add content for empty cards if needed -->
            <div class="card-body">
              <i class="fa-solid fa-car"></i>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p>You don't have any cars yet.</p>
  <% end %>

</section>


<section class="section-2" id="my-bookings">
  <h2>My Bookings</h2>
  <% if current_user.bookings.any? %>
    <div class="row mx-2">
      <% current_user.bookings.each do |booking| %>
        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <%= image_tag booking.car.photo_url, class: 'card-img-top', alt: 'Booked Car Image' %>
            <div class="card-body">
              <h5 class="card-title"><strong><%= booking.car.brand %></strong></h5>
              <p class="card-text text-truncate"><strong>Booking Dates:</strong> <%= booking.date_begin %> to <%= booking.date_end %></p>
              <p class="card-text text-truncate"><strong>Message:</strong> <%= booking.message %></p>
              <p class="card-text text-truncate"><strong>Status:</strong> <%= booking.status %></p>
            </div>
          </div>
        </div>
      <% end %>

      <% # Add empty cards if there are fewer than 3 bookings %>
      <% (3 - current_user.bookings.count).times do %>
        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <!-- Add content for empty cards if needed -->
            <div class="card-body">
              <i class="fa-solid fa-bookmark"></i>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p>You haven't booked any cars yet.</p>
  <% end %>
</section>






<%# **************************** %>






<!-- Modal -->


<%# Modals %>

<!-- Modal -->
